/**
          * @ag-grid-enterprise/set-filter - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v29.1.0
          * @link https://www.ag-grid.com/
          * @license Commercial
          */
/**
          * @ag-grid-enterprise/set-filter - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v29.1.0
          * @link https://www.ag-grid.com/
          * @license Commercial
          */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t=require("@ag-grid-community/core"),r=require("@ag-grid-enterprise/core"),i=function(){function e(e,t,r,i,n,o,l,s,a){this.rowModel=e,this.filterParams=t,this.createKey=r,this.caseFormat=i,this.columnModel=n,this.valueService=o,this.treeDataOrGrouping=l,this.treeData=s,this.getDataPath=a}return e.prototype.extractUniqueValues=function(e,r){var i=this,n=new Map,o=this.extractExistingFormattedKeys(r),l=new Set,s=this.treeData&&!!this.getDataPath,a=this.columnModel.getRowGroupColumns(),u=function(e,s){var a=i.caseFormat(e);if(!l.has(a)){l.add(a);var u=e,c=t._.makeNull(s),d=null==o?void 0:o.get(a);null!=d&&(u=d,c=r.get(d)),n.set(u,c)}};return this.rowModel.forEachLeafNode((function(t){if(t.data&&e(t))if(i.treeDataOrGrouping)i.addValueForTreeDataOrGrouping(t,s,a,u);else{var r=i.getValue(t);i.filterParams.convertValuesToStrings?i.addValueForConvertValuesToString(t,r,u):null!=r&&Array.isArray(r)?(r.forEach((function(e){u(i.createKey(e,t),e)})),0===r.length&&u(null,null)):u(i.createKey(r,t),r)}})),n},e.prototype.addValueForConvertValuesToString=function(e,r,i){var n=this.createKey(r,e);null!=n&&Array.isArray(n)?(n.forEach((function(e){var r=t._.toStringOrNull(t._.makeNull(e));i(r,r)})),0===n.length&&i(null,null)):i(n,n)},e.prototype.addValueForTreeDataOrGrouping=function(e,r,i,n){var o,l,s=this;if(r){if(null===(o=e.childrenAfterGroup)||void 0===o?void 0:o.length)return;l=this.getDataPath(e.data)}else(l=i.map((function(t){return s.valueService.getKeyForNode(t,e)}))).push(this.getValue(e));l&&(l=l.map((function(e){return t._.toStringOrNull(t._.makeNull(e))}))),(null==l?void 0:l.some((function(e){return null==e})))&&(l=null),n(this.createKey(l),l)},e.prototype.getValue=function(e){var t=this.filterParams,r=t.api,i=t.colDef,n=t.column,o=t.columnApi,l=t.context;return this.filterParams.valueGetter({api:r,colDef:i,column:n,columnApi:o,context:l,data:e.data,getValue:function(t){return e.data[t]},node:e})},e.prototype.extractExistingFormattedKeys=function(e){var t=this;if(!e)return null;var r=new Map;return e.forEach((function(e,i){r.set(t.caseFormat(i),i)})),r},e}(),n=function(){function e(){}return e.SELECT_ALL="__AG_SELECT_ALL__",e}(),o=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},l=function(){function e(e,t,r,i){this.valueFormatterService=e,this.valueFormatter=t,this.formatter=r,this.column=i,this.displayedKeys=[]}return e.prototype.updateDisplayedValuesToAllAvailable=function(e,t,r){this.displayedKeys=Array.from(r)},e.prototype.updateDisplayedValuesToMatchMiniFilter=function(e,t,r,i,n){var l,s;this.displayedKeys=[];try{for(var a=o(r),u=a.next();!u.done;u=a.next()){var c=u.value;if(null==c)n&&this.displayedKeys.push(c);else{var d=e(c),h=this.valueFormatterService.formatValue(this.column,null,d,this.valueFormatter,!1);i(this.formatter(h))&&this.displayedKeys.push(c)}}}catch(e){l={error:e}}finally{try{u&&!u.done&&(s=a.return)&&s.call(a)}finally{if(l)throw l.error}}},e.prototype.getDisplayedValueCount=function(){return this.displayedKeys.length},e.prototype.getDisplayedItem=function(e){return this.displayedKeys[e]},e.prototype.getSelectAllItem=function(){return n.SELECT_ALL},e.prototype.getDisplayedKeys=function(){return this.displayedKeys},e.prototype.forEachDisplayedKey=function(e){this.displayedKeys.forEach(e)},e.prototype.someDisplayedKey=function(e){return this.displayedKeys.some(e)},e.prototype.hasGroups=function(){return!1},e.prototype.refresh=function(){},e}(),s=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,o=r.call(e),l=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)l.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return l},a=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(s(arguments[t]));return e},u=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},c=function(){function e(e,t,r,i){this.formatter=e,this.treeListPathGetter=t,this.treeListFormatter=r,this.treeDataOrGrouping=i,this.allDisplayedItemsTree=[],this.activeDisplayedItemsFlat=[],this.selectAllItem={depth:0,filterPasses:!0,available:!0,treeKey:n.SELECT_ALL,children:this.allDisplayedItemsTree,expanded:!0,key:n.SELECT_ALL,parentTreeKeys:[]}}return e.prototype.updateDisplayedValuesToAllAvailable=function(e,t,r,i){"reload"===i?this.generateItemTree(e,t,r):"otherFilter"===i?(this.updateAvailable(r),this.updateExpandAll()):"miniFilter"===i&&(this.resetFilter(),this.updateExpandAll()),this.flattenItems()},e.prototype.updateDisplayedValuesToMatchMiniFilter=function(e,t,r,i,n,o){"reload"===o?this.generateItemTree(e,t,r):"otherFilter"===o&&this.updateAvailable(r),this.updateFilter(i,n),this.updateExpandAll(),this.flattenItems()},e.prototype.generateItemTree=function(e,t,r){var i,n,o;this.allDisplayedItemsTree=[],this.groupsExist=!1;var l=this.getTreeListPathGetter(e,r),s=function(t){var i=e(t),n=null!==(o=l(i))&&void 0!==o?o:[null];n.length>1&&(c.groupsExist=!0);var s,u=r.has(t),d=c.allDisplayedItemsTree,h=[];n.forEach((function(e,r){d||(d=[],s.children=d),(s=d.find((function(t){var r;return(null===(r=t.treeKey)||void 0===r?void 0:r.toUpperCase())===(null==e?void 0:e.toUpperCase())})))||(s={treeKey:e,depth:r,filterPasses:!0,expanded:!1,available:u,parentTreeKeys:h},r===n.length-1&&(s.key=t),d.push(s)),d=s.children,h=a(h,[e])}))},c=this;try{for(var d=u(t),h=d.next();!h.done;h=d.next()){s(h.value)}}catch(e){i={error:e}}finally{try{h&&!h.done&&(n=d.return)&&n.call(d)}finally{if(i)throw i.error}}this.updateAvailable(r),this.selectAllItem.children=this.allDisplayedItemsTree,this.selectAllItem.expanded=!1},e.prototype.getTreeListPathGetter=function(r,i){var n,o;if(this.treeListPathGetter)return this.treeListPathGetter;if(this.treeDataOrGrouping)return function(e){return e};var l=!1;try{for(var s=u(i),a=s.next();!a.done;a=s.next()){var c=r(a.value);if(c instanceof Date){l=!0;break}if(null!=c)break}}catch(e){n={error:e}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}return l?e.DATE_TREE_LIST_PATH_GETTER:(t._.doOnce((function(){return console.warn("AG Grid: property treeList=true for Set Filter params, but you did not provide a treeListPathGetter or values of type Date.")}),"getTreeListPathGetter"),function(e){return[String(e)]})},e.prototype.flattenItems=function(){var e=this;this.activeDisplayedItemsFlat=[];var t=function(r){r.forEach((function(r){r.filterPasses&&r.available&&(e.activeDisplayedItemsFlat.push(r),r.children&&r.expanded&&t(r.children))}))};t(this.allDisplayedItemsTree)},e.prototype.resetFilter=function(){var e=function(t){t.children&&t.children.forEach((function(t){e(t)})),t.filterPasses=!0};this.allDisplayedItemsTree.forEach((function(t){return e(t)}))},e.prototype.updateFilter=function(e,t){var r=this,i=function(i){return!!i.available&&(null==i.treeKey?t:e(r.formatter(r.treeListFormatter?r.treeListFormatter(i.treeKey,i.depth,i.parentTreeKeys):i.treeKey)))};this.allDisplayedItemsTree.forEach((function(e){return r.recursiveItemCheck(e,!1,i,"filterPasses")}))},e.prototype.getDisplayedValueCount=function(){return this.activeDisplayedItemsFlat.length},e.prototype.getDisplayedItem=function(e){return this.activeDisplayedItemsFlat[e]},e.prototype.getSelectAllItem=function(){return this.selectAllItem},e.prototype.getDisplayedKeys=function(){return this.activeDisplayedItemsFlat.map((function(e){return e.treeKey}))},e.prototype.forEachDisplayedKey=function(e){var t=function(r,i){r.children?r.expanded&&i||r.children.forEach((function(e){e.filterPasses&&t(e,!1)})):e(r.key)};this.activeDisplayedItemsFlat.forEach((function(e){return t(e,!0)}))},e.prototype.someDisplayedKey=function(e){var t=function(r,i){return r.children?(!r.expanded||!i)&&r.children.some((function(e){return!!e.filterPasses&&t(e,!1)})):e(r.key)};return this.activeDisplayedItemsFlat.some((function(e){return t(e,!0)}))},e.prototype.hasGroups=function(){return this.groupsExist},e.prototype.refresh=function(){this.updateExpandAll(),this.flattenItems()},e.prototype.updateExpandAll=function(){var e=function(t,r,i){var n,o;try{for(var l=u(t),s=l.next();!s.done;s=l.next()){var a=s.value;if(a.filterPasses&&a.available&&a.children){if(r=r||!!a.expanded,i=i||!a.expanded,r&&i)return;var c=e(a.children,r,i);if(void 0===c)return;c?r=!0:i=!0}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(o=l.return)&&o.call(l)}finally{if(n)throw n.error}}return r&&i?void 0:r},t=this.getSelectAllItem();t.expanded=e(t.children,!1,!1)},e.prototype.recursiveItemCheck=function(e,t,r,i){var n=this,o=!1;e.children&&e.children.forEach((function(l){var s=n.recursiveItemCheck(l,t||r(e),r,i);o=o||s}));var l=t||o||r(e);return e[i]=l,l},e.prototype.updateAvailable=function(e){var t=this,r=function(t){return e.has(t.key)};this.allDisplayedItemsTree.forEach((function(e){return t.recursiveItemCheck(e,!1,r,"available")}))},e.DATE_TREE_LIST_PATH_GETTER=function(e){return e?[String(e.getFullYear()),String(e.getMonth()+1),String(e.getDate())]:null},e}(),d=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,o=r.call(e),l=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)l.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return l};!function(e){e[e.PROVIDED_LIST=0]="PROVIDED_LIST",e[e.PROVIDED_CALLBACK=1]="PROVIDED_CALLBACK",e[e.TAKEN_FROM_GRID_VALUES=2]="TAKEN_FROM_GRID_VALUES"}(e||(e={}));var h,p=function(){function r(r){var n,o=this;this.localEventService=new t.EventService,this.miniFilterText=null,this.providedValues=null,this.allValues=new Map,this.availableKeys=new Set,this.selectedKeys=new Set,this.initialised=!1;var s=r.usingComplexObjects,a=r.columnModel,u=r.valueService,h=r.treeDataTreeList,p=r.groupingTreeList,f=r.filterParams,y=r.gridOptionsService,v=r.valueFormatterService,m=r.valueFormatter,g=f.column,F=f.colDef,S=f.textFormatter,E=f.doesRowPassOtherFilter,M=f.suppressSorting,A=f.comparator,V=f.rowModel,b=f.values,L=f.caseSensitive,T=f.convertValuesToStrings,C=f.treeList,w=f.treeListPathGetter,x=f.treeListFormatter;this.filterParams=f,this.setIsLoading=r.setIsLoading,this.translate=r.translate,this.caseFormat=r.caseFormat,this.createKey=r.createKey,this.usingComplexObjects=!!r.usingComplexObjects,this.formatter=S||t.TextFilter.DEFAULT_FORMATTER,this.doesRowPassOtherFilters=E,this.suppressSorting=M||!1,this.convertValuesToStrings=!!T;var P=null!=A?A:F.comparator,D=!!h||!!p;this.compareByValue=!!(s&&P||D||C&&!w),this.entryComparator=D&&!P?this.createTreeDataOrGroupingComparator():!C||w||P?function(e,t){var r=d(e,2);r[0];var i=r[1],n=d(t,2);n[0];var o=n[1];return P(i,o)}:function(e,r){var i=d(e,2);i[0];var n=i[1],o=d(r,2);o[0];var l=o[1];return t._.defaultComparator(n,l)},this.keyComparator=null!==(n=P)&&void 0!==n?n:t._.defaultComparator,this.caseSensitive=!!L;var I=y.get("getDataPath");"clientSide"===V.getType()&&(this.clientSideValuesExtractor=new i(V,this.filterParams,this.createKey,this.caseFormat,a,u,D,!!h,I)),null==b?this.valuesType=e.TAKEN_FROM_GRID_VALUES:(this.valuesType=Array.isArray(b)?e.PROVIDED_LIST:e.PROVIDED_CALLBACK,this.providedValues=b),this.displayValueModel=C?new c(this.formatter,w,x,h||p):new l(v,m,this.formatter,g),this.updateAllValues().then((function(e){return o.resetSelectionState(e||[])}))}return r.prototype.addEventListener=function(e,t,r){this.localEventService.addEventListener(e,t,r)},r.prototype.removeEventListener=function(e,t,r){this.localEventService.removeEventListener(e,t,r)},r.prototype.refreshValues=function(){var e=this.getModel();return this.updateAllValues(),this.setModel(e)},r.prototype.overrideValues=function(r){var i=this;return new t.AgPromise((function(t){i.allValuesPromise.then((function(){i.valuesType=e.PROVIDED_LIST,i.providedValues=r,i.refreshValues().then((function(){return t()}))}))}))},r.prototype.refreshAfterAnyFilterChanged=function(){var e=this;return this.showAvailableOnly()?this.allValuesPromise.then((function(t){return e.updateAvailableKeys(null!=t?t:[],"otherFilter"),!0})):t.AgPromise.resolve(!1)},r.prototype.isInitialised=function(){return this.initialised},r.prototype.updateAllValues=function(){var r=this;return this.allValuesPromise=new t.AgPromise((function(t){switch(r.valuesType){case e.TAKEN_FROM_GRID_VALUES:case e.PROVIDED_LIST:t(r.processAllKeys(r.valuesType===e.TAKEN_FROM_GRID_VALUES,r.providedValues));break;case e.PROVIDED_CALLBACK:r.setIsLoading(!0);var i=r.providedValues,n=r.filterParams,o=n.columnApi,l=n.api,s=n.context,a=n.column,u={success:function(e){r.setIsLoading(!1),t(r.processAllKeys(!1,e))},colDef:n.colDef,column:a,columnApi:o,api:l,context:s};window.setTimeout((function(){return i(u)}),0);break;default:throw new Error("Unrecognised valuesType")}})),this.allValuesPromise.then((function(e){return r.updateAvailableKeys(e||[],"reload")})).then((function(){return r.initialised=!0})),this.allValuesPromise},r.prototype.processAllKeys=function(e,t){var r=e?this.getValuesFromRows(!1):this.uniqueValues(this.validateProvidedValues(t)),i=this.sortKeys(r);return this.allValues=null!=r?r:new Map,i},r.prototype.validateProvidedValues=function(e){if(this.usingComplexObjects&&(null==e?void 0:e.length)){var r=e[0];if(r&&"object"!=typeof r&&"function"!=typeof r)null==this.createKey(r)?t._.doOnce((function(){return console.warn("Set Filter Key Creator is returning null for provided values and provided values are primitives. Please provide complex objects or set convertValuesToStrings=true in the filterParams. See https://www.ag-grid.com/javascript-data-grid/filter-set-filter-list/#filter-value-types")}),"setFilterComplexObjectsProvidedNull"):t._.doOnce((function(){return console.warn("AG Grid: Set Filter has a Key Creator, but provided values are primitives. Did you mean to provide complex objects or enable convertValuesToStrings?")}),"setFilterComplexObjectsProvidedPrimitive")}return e},r.prototype.setValuesType=function(e){this.valuesType=e},r.prototype.getValuesType=function(){return this.valuesType},r.prototype.isKeyAvailable=function(e){return this.availableKeys.has(e)},r.prototype.showAvailableOnly=function(){return this.valuesType===e.TAKEN_FROM_GRID_VALUES},r.prototype.updateAvailableKeys=function(e,t){var i=this.showAvailableOnly()?this.sortKeys(this.getValuesFromRows(!0)):e;this.availableKeys=new Set(i),this.localEventService.dispatchEvent({type:r.EVENT_AVAILABLE_VALUES_CHANGED}),this.updateDisplayedValues(t,e)},r.prototype.sortKeys=function(e){var t,r=null!=e?e:new Map;return this.suppressSorting?Array.from(r.keys()):(t=this.compareByValue?Array.from(r.entries()).sort(this.entryComparator).map((function(e){return d(e,1)[0]})):Array.from(r.keys()).sort(this.keyComparator),this.filterParams.excelMode&&r.has(null)&&(t=t.filter((function(e){return null!=e}))).push(null),t)},r.prototype.getValuesFromRows=function(e){var t=this;if(void 0===e&&(e=!1),!this.clientSideValuesExtractor)return console.error("AG Grid: Set Filter cannot initialise because you are using a row model that does not contain all rows in the browser. Either use a different filter type, or configure Set Filter such that you provide it with values"),null;return this.clientSideValuesExtractor.extractUniqueValues((function(r){return!e||t.doesRowPassOtherFilters(r)}),e&&!this.caseSensitive?this.allValues:void 0)},r.prototype.setMiniFilter=function(e){return e=t._.makeNull(e),this.miniFilterText!==e&&(this.miniFilterText=e,this.updateDisplayedValues("miniFilter"),!0)},r.prototype.getMiniFilter=function(){return this.miniFilterText},r.prototype.updateDisplayedValues=function(e,t){var r=this;if("expansion"!==e)if(null!=this.miniFilterText){var i=this.caseFormat(this.formatter(this.miniFilterText)||""),n=function(e){return null!=e&&r.caseFormat(e).indexOf(i)>=0},o=!!this.filterParams.excelMode&&n(this.translate("blanks"));this.displayValueModel.updateDisplayedValuesToMatchMiniFilter((function(e){return r.getValue(e)}),t,this.availableKeys,n,o,e)}else this.displayValueModel.updateDisplayedValuesToAllAvailable((function(e){return r.getValue(e)}),t,this.availableKeys,e);else this.displayValueModel.refresh()},r.prototype.getDisplayedValueCount=function(){return this.displayValueModel.getDisplayedValueCount()},r.prototype.getDisplayedItem=function(e){return this.displayValueModel.getDisplayedItem(e)},r.prototype.getSelectAllItem=function(){return this.displayValueModel.getSelectAllItem()},r.prototype.hasSelections=function(){return this.filterParams.defaultToNothingSelected?this.selectedKeys.size>0:this.allValues.size!==this.selectedKeys.size},r.prototype.getKeys=function(){return Array.from(this.allValues.keys())},r.prototype.getValues=function(){return Array.from(this.allValues.values())},r.prototype.getValue=function(e){return this.allValues.get(e)},r.prototype.selectAllMatchingMiniFilter=function(e){var t=this;void 0===e&&(e=!1),null==this.miniFilterText?this.selectedKeys=new Set(this.allValues.keys()):(e&&this.selectedKeys.clear(),this.displayValueModel.forEachDisplayedKey((function(e){return t.selectedKeys.add(e)})))},r.prototype.deselectAllMatchingMiniFilter=function(){var e=this;null==this.miniFilterText?this.selectedKeys.clear():this.displayValueModel.forEachDisplayedKey((function(t){return e.selectedKeys.delete(t)}))},r.prototype.selectKey=function(e){this.selectedKeys.add(e)},r.prototype.deselectKey=function(e){this.filterParams.excelMode&&this.isEverythingVisibleSelected()&&this.resetSelectionState(this.displayValueModel.getDisplayedKeys()),this.selectedKeys.delete(e)},r.prototype.isKeySelected=function(e){return this.selectedKeys.has(e)},r.prototype.isEverythingVisibleSelected=function(){var e=this;return!this.displayValueModel.someDisplayedKey((function(t){return!e.isKeySelected(t)}))},r.prototype.isNothingVisibleSelected=function(){var e=this;return!this.displayValueModel.someDisplayedKey((function(t){return e.isKeySelected(t)}))},r.prototype.getModel=function(){return this.hasSelections()?Array.from(this.selectedKeys):null},r.prototype.setModel=function(e){var t=this;return this.allValuesPromise.then((function(r){if(null==e)t.resetSelectionState(null!=r?r:[]);else{t.selectedKeys.clear();var i=new Map;t.allValues.forEach((function(e,r){i.set(t.caseFormat(r),r)})),e.forEach((function(e){var r=t.caseFormat(e),n=i.get(r);void 0!==n&&t.selectKey(n)}))}}))},r.prototype.uniqueValues=function(e){var r=this,i=new Map,n=new Set;return(null!=e?e:[]).forEach((function(e){var o=t._.makeNull(e),l=r.convertAndGetKey(o),s=r.caseFormat(l);n.has(s)||(n.add(s),i.set(l,o))})),i},r.prototype.convertAndGetKey=function(e){return this.convertValuesToStrings?e:this.createKey(e)},r.prototype.resetSelectionState=function(e){this.filterParams.defaultToNothingSelected?this.selectedKeys.clear():this.selectedKeys=new Set(e)},r.prototype.hasGroups=function(){return this.displayValueModel.hasGroups()},r.prototype.createTreeDataOrGroupingComparator=function(){return function(e,r){var i=d(e,2);i[0];var n=i[1],o=d(r,2);o[0];var l=o[1];if(null==n)return null==l?0:-1;if(null==l)return 1;for(var s=0;s<n.length;s++){if(s>=l.length)return 1;var a=t._.defaultComparator(n[s],l[s]);if(0!==a)return a}return 0}},r.EVENT_AVAILABLE_VALUES_CHANGED="availableValuesChanged",r}(),f=(h=function(e,t){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}h(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),y=function(e,t,r,i){var n,o=arguments.length,l=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(l=(o<3?n(l):o>3?n(t,r,l):n(t,r))||l);return o>3&&l&&Object.defineProperty(t,r,l),l},v=function(e){function r(t){var i,n=e.call(this,t.isGroup?r.GROUP_TEMPLATE:r.TEMPLATE)||this;return n.focusWrapper=t.focusWrapper,n.value=t.value,n.params=t.params,n.translate=t.translate,n.valueFormatter=t.valueFormatter,n.item=t.item,n.isSelected=t.isSelected,n.isTree=t.isTree,n.depth=null!==(i=t.depth)&&void 0!==i?i:0,n.isGroup=t.isGroup,n.groupsExist=t.groupsExist,n.isExpanded=t.isExpanded,n.hasIndeterminateExpandState=t.hasIndeterminateExpandState,n}return f(r,e),r.prototype.init=function(){var e=this;this.render(),this.eCheckbox.setLabelEllipsis(!0),this.eCheckbox.setValue(this.isSelected,!0),this.eCheckbox.setDisabled(!!this.params.readOnly),this.eCheckbox.getInputElement().setAttribute("tabindex","-1"),this.refreshVariableAriaLabels(),this.isTree&&(this.depth>0&&this.addCssClass("ag-set-filter-indent-"+this.depth),this.isGroup?this.setupExpansion():this.groupsExist&&this.addCssClass("ag-set-filter-add-group-indent"),t._.setAriaLevel(this.focusWrapper,this.depth+1)),this.params.readOnly||this.eCheckbox.onValueChange((function(t){return e.onCheckboxChanged(!!t)}))},r.prototype.setupExpansion=function(){this.eGroupClosedIcon.appendChild(t._.createIcon("setFilterGroupClosed",this.gridOptionsService,null)),this.eGroupOpenedIcon.appendChild(t._.createIcon("setFilterGroupOpen",this.gridOptionsService,null)),this.addManagedListener(this.eGroupClosedIcon,"click",this.onExpandOrContractClicked.bind(this)),this.addManagedListener(this.eGroupOpenedIcon,"click",this.onExpandOrContractClicked.bind(this)),this.hasIndeterminateExpandState&&(this.eGroupIndeterminateIcon.appendChild(t._.createIcon("setFilterGroupIndeterminate",this.gridOptionsService,null)),this.addManagedListener(this.eGroupIndeterminateIcon,"click",this.onExpandOrContractClicked.bind(this))),this.setExpandedIcons(),this.refreshAriaExpanded()},r.prototype.onExpandOrContractClicked=function(){this.setExpanded(!this.isExpanded)},r.prototype.setExpanded=function(e,t){if(this.isGroup&&e!==this.isExpanded){this.isExpanded=e;var i={type:r.EVENT_EXPANDED_CHANGED,isExpanded:!!e,item:this.item};t||this.dispatchEvent(i),this.setExpandedIcons(),this.refreshAriaExpanded()}},r.prototype.refreshAriaExpanded=function(){t._.setAriaExpanded(this.focusWrapper,!!this.isExpanded)},r.prototype.setExpandedIcons=function(){t._.setDisplayed(this.eGroupClosedIcon,this.hasIndeterminateExpandState?!1===this.isExpanded:!this.isExpanded),t._.setDisplayed(this.eGroupOpenedIcon,!0===this.isExpanded),this.hasIndeterminateExpandState&&t._.setDisplayed(this.eGroupIndeterminateIcon,void 0===this.isExpanded)},r.prototype.onCheckboxChanged=function(e){this.isSelected=e;var t={type:r.EVENT_SELECTION_CHANGED,isSelected:e,item:this.item};this.dispatchEvent(t),this.refreshVariableAriaLabels()},r.prototype.toggleSelected=function(){this.params.readOnly||this.setSelected(!this.isSelected)},r.prototype.setSelected=function(e,t){this.isSelected=e,this.eCheckbox.setValue(this.isSelected,t)},r.prototype.refreshVariableAriaLabels=function(){if(this.isTree){var e=this.localeService.getLocaleTextFunc(),r=this.eCheckbox.getValue(),i=void 0===r?e("ariaIndeterminate","indeterminate"):r?e("ariaVisible","visible"):e("ariaHidden","hidden"),n=e("ariaToggleVisibility","Press SPACE to toggle visibility");t._.setAriaLabelledBy(this.eCheckbox.getInputElement(),void 0),this.eCheckbox.setInputAriaLabel(n+" ("+i+")")}},r.prototype.setupFixedAriaLabels=function(e){if(this.isTree){var r=this.localeService.getLocaleTextFunc()("ariaFilterValue","Filter Value");t._.setAriaLabel(this.focusWrapper,e+" "+r),t._.setAriaDescribedBy(this.focusWrapper,this.eCheckbox.getInputElement().id)}},r.prototype.refresh=function(e,t,r){var i,n;if(this.item=e,t!==this.isSelected&&this.setSelected(t,!0),this.setExpanded(r,!0),this.valueFunction){var o=this.valueFunction();this.setTooltipAndCellRendererParams(o,o),this.cellRendererComponent||this.renderCellWithoutCellRenderer()}null===(n=null===(i=this.cellRendererComponent)||void 0===i?void 0:i.refresh)||void 0===n||n.call(i,this.cellRendererParams)},r.prototype.render=function(){var e=this.params.column,r=this.value,i=null;"function"==typeof r?(this.valueFunction=r,r=i=this.valueFunction()):i=this.isTree?t._.toStringOrNull(r):this.getFormattedValue(e,r),this.setTooltipAndCellRendererParams(r,i),this.renderCell()},r.prototype.setTooltipAndCellRendererParams=function(e,r){if(this.params.showTooltips){var i=null!=r?r:t._.toStringOrNull(e);this.setTooltip(i)}this.cellRendererParams={value:e,valueFormatted:r,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,colDef:this.params.colDef,column:this.params.column}},r.prototype.getTooltipParams=function(){var t=e.prototype.getTooltipParams.call(this);return t.location="setFilterValue",t.colDef=this.getComponentHolder(),this.isTree&&(t.level=this.depth),t},r.prototype.getFormattedValue=function(e,t){return this.valueFormatterService.formatValue(e,null,t,this.valueFormatter,!1)},r.prototype.renderCell=function(){var e=this,t=this.userComponentFactory.getSetFilterCellRendererDetails(this.params,this.cellRendererParams),r=t?t.newAgStackInstance():void 0;null!=r?r.then((function(t){t&&(e.cellRendererComponent=t,e.eCheckbox.setLabel(t.getGui()),e.addDestroyFunc((function(){return e.destroyBean(t)})))})):this.renderCellWithoutCellRenderer()},r.prototype.renderCellWithoutCellRenderer=function(){var e,r=null!==(e=null==this.cellRendererParams.valueFormatted?this.cellRendererParams.value:this.cellRendererParams.valueFormatted)&&void 0!==e?e:this.translate("blanks");"string"!=typeof r&&(t._.doOnce((function(){return console.warn("AG Grid: Set Filter Value Formatter must return string values. Please ensure the Set Filter Value Formatter returns string values for complex objects, or set convertValuesToStrings=true in the filterParams. See https://www.ag-grid.com/javascript-data-grid/filter-set-filter-list/#filter-value-types")}),"setFilterComplexObjectsValueFormatter"),r=""),this.eCheckbox.setLabel(r),this.setupFixedAriaLabels(r)},r.prototype.getComponentHolder=function(){return this.params.column.getColDef()},r.EVENT_SELECTION_CHANGED="selectionChanged",r.EVENT_EXPANDED_CHANGED="expandedChanged",r.GROUP_TEMPLATE='\n        <div class="ag-set-filter-item" aria-hidden="true">\n            <span class="ag-set-filter-group-icons">\n                <span class="ag-set-filter-group-closed-icon" ref="eGroupClosedIcon"></span>\n                <span class="ag-set-filter-group-opened-icon" ref="eGroupOpenedIcon"></span>\n                <span class="ag-set-filter-group-indeterminate-icon" ref="eGroupIndeterminateIcon"></span>\n            </span>\n            <ag-checkbox ref="eCheckbox" class="ag-set-filter-item-checkbox"></ag-checkbox>\n        </div>',r.TEMPLATE='\n        <div class="ag-set-filter-item">\n            <ag-checkbox ref="eCheckbox" class="ag-set-filter-item-checkbox"></ag-checkbox>\n        </div>',y([t.Autowired("valueFormatterService")],r.prototype,"valueFormatterService",void 0),y([t.Autowired("userComponentFactory")],r.prototype,"userComponentFactory",void 0),y([t.RefSelector("eCheckbox")],r.prototype,"eCheckbox",void 0),y([t.RefSelector("eGroupOpenedIcon")],r.prototype,"eGroupOpenedIcon",void 0),y([t.RefSelector("eGroupClosedIcon")],r.prototype,"eGroupClosedIcon",void 0),y([t.RefSelector("eGroupIndeterminateIcon")],r.prototype,"eGroupIndeterminateIcon",void 0),y([t.PostConstruct],r.prototype,"init",null),r}(t.Component),m={loadingOoo:"Loading...",blanks:"(Blanks)",searchOoo:"Search...",selectAll:"(Select All)",selectAllSearchResults:"(Select All Search Results)",noMatches:"No matches."},g=function(){function e(){}return e.prototype.getModelAsString=function(e,t){var r=(e||t.getModel()||{}).values,i=t.getValueModel();if(null==r||null==i)return"";var n=r.filter((function(e){return i.isKeyAvailable(e)})),o=n.length;return"("+o+") "+n.slice(0,10).map((function(e){return t.getFormattedValue(e)})).join(",")+(o>10?",...":"")},e}(),F=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),S=function(e,t,r,i){var n,o=arguments.length,l=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(l=(o<3?n(l):o>3?n(t,r,l):n(t,r))||l);return o>3&&l&&Object.defineProperty(t,r,l),l},E=function(r){function i(){var e=r.call(this,"setFilter")||this;return e.valueModel=null,e.setFilterParams=null,e.virtualList=null,e.caseSensitive=!1,e.convertValuesToStrings=!1,e.treeDataTreeList=!1,e.groupingTreeList=!1,e.hardRefreshVirtualList=!1,e.appliedModelKeys=null,e.noAppliedModelKeys=!1,e.filterModelFormatter=new g,e}return F(i,r),i.prototype.postConstruct=function(){r.prototype.postConstruct.call(this),this.positionableFeature=new t.PositionableFeature(this.eSetFilterList,{forcePopupParentAsOffsetParent:!0}),this.createBean(this.positionableFeature)},i.prototype.updateUiVisibility=function(){},i.prototype.createBodyTemplate=function(){return'\n            <div class="ag-set-filter">\n                <div ref="eFilterLoading" class="ag-filter-loading ag-hidden">'+this.translateForSetFilter("loadingOoo")+'</div>\n                <ag-input-text-field class="ag-mini-filter" ref="eMiniFilter"></ag-input-text-field>\n                <div ref="eFilterNoMatches" class="ag-filter-no-matches ag-hidden">'+this.translateForSetFilter("noMatches")+'</div>\n                <div ref="eSetFilterList" class="ag-set-filter-list" role="presentation"></div>\n            </div>'},i.prototype.handleKeyDown=function(e){if(r.prototype.handleKeyDown.call(this,e),!e.defaultPrevented)switch(e.key){case t.KeyCode.SPACE:this.handleKeySpace(e);break;case t.KeyCode.ENTER:this.handleKeyEnter(e);break;case t.KeyCode.LEFT:this.handleKeyLeft(e);break;case t.KeyCode.RIGHT:this.handleKeyRight(e)}},i.prototype.handleKeySpace=function(e){var t;null===(t=this.getComponentForKeyEvent(e))||void 0===t||t.toggleSelected()},i.prototype.handleKeyEnter=function(e){if(this.setFilterParams){var t=this.setFilterParams||{},r=t.excelMode,i=t.readOnly;r&&!i&&(e.preventDefault(),this.onBtApply(!1,!1,e),"mac"===this.setFilterParams.excelMode&&this.eMiniFilter.getInputElement().select())}},i.prototype.handleKeyLeft=function(e){var t;null===(t=this.getComponentForKeyEvent(e))||void 0===t||t.setExpanded(!1)},i.prototype.handleKeyRight=function(e){var t;null===(t=this.getComponentForKeyEvent(e))||void 0===t||t.setExpanded(!0)},i.prototype.getComponentForKeyEvent=function(e){var t,r=this.gridOptionsService.getDocument();if(this.eSetFilterList.contains(r.activeElement)&&this.virtualList){var i=this.virtualList.getLastFocusedRow();if(null!=i){var n=this.virtualList.getComponentAt(i);if(null!=n)if(e.preventDefault(),!(null!==(t=this.setFilterParams)&&void 0!==t?t:{}).readOnly)return n}}},i.prototype.getCssIdentifier=function(){return"set-filter"},i.prototype.setModel=function(e){var i;return null==e&&null==(null===(i=this.valueModel)||void 0===i?void 0:i.getModel())?(this.setMiniFilter(null),t.AgPromise.resolve()):r.prototype.setModel.call(this,e)},i.prototype.setModelAndRefresh=function(e){var r=this;return this.valueModel?this.valueModel.setModel(e).then((function(){return r.refresh()})):t.AgPromise.resolve()},i.prototype.resetUiToDefaults=function(){return this.setMiniFilter(null),this.setModelAndRefresh(null)},i.prototype.setModelIntoUi=function(e){this.setMiniFilter(null);var t=null==e?null:e.values;return this.setModelAndRefresh(t)},i.prototype.getModelFromUi=function(){if(!this.valueModel)throw new Error("Value model has not been created.");var e=this.valueModel.getModel();return e?{values:e,filterType:this.getFilterType()}:null},i.prototype.getFilterType=function(){return"set"},i.prototype.getValueModel=function(){return this.valueModel},i.prototype.areModelsEqual=function(e,r){return null==e&&null==r||null!=e&&null!=r&&t._.areEqual(e.values,r.values)},i.prototype.setParams=function(e){var i,n=this;this.applyExcelModeOptions(e),r.prototype.setParams.call(this,e),this.setFilterParams=e,this.convertValuesToStrings=!!e.convertValuesToStrings,this.caseSensitive=!!e.caseSensitive;var o=null!==(i=e.keyCreator)&&void 0!==i?i:e.colDef.keyCreator;this.setValueFormatter(e.valueFormatter,o,this.convertValuesToStrings,!!e.treeList,!!e.colDef.refData);var l=e.column.getId().startsWith(t.GROUP_AUTO_COLUMN_ID);this.treeDataTreeList=this.gridOptionsService.is("treeData")&&!!e.treeList&&l,this.getDataPath=this.gridOptionsService.get("getDataPath"),this.groupingTreeList=!!this.columnModel.getRowGroupColumns().length&&!!e.treeList&&l,this.createKey=this.generateCreateKey(o,this.convertValuesToStrings,this.treeDataTreeList||this.groupingTreeList),this.valueModel=new p({filterParams:e,setIsLoading:function(e){return n.setIsLoading(e)},valueFormatterService:this.valueFormatterService,translate:function(e){return n.translateForSetFilter(e)},caseFormat:function(e){return n.caseFormat(e)},createKey:this.createKey,valueFormatter:this.valueFormatter,usingComplexObjects:!!o,gridOptionsService:this.gridOptionsService,columnModel:this.columnModel,valueService:this.valueService,treeDataTreeList:this.treeDataTreeList,groupingTreeList:this.groupingTreeList}),this.initialiseFilterBodyUi(),this.addEventListenersForDataChanges()},i.prototype.setValueFormatter=function(e,r,i,n,o){var l=e;if(!l){if(r&&!i&&!n)throw new Error("AG Grid: Must supply a Value Formatter in Set Filter params when using a Key Creator unless convertValuesToStrings is enabled");o||(l=function(e){return t._.toStringOrNull(e.value)})}this.valueFormatter=l},i.prototype.generateCreateKey=function(e,r,i){var n=this;if(i&&!e)throw new Error("AG Grid: Must supply a Key Creator in Set Filter params when `treeList = true` on a group column, and Tree Data or Row Grouping is enabled.");return e?function(r,i){void 0===i&&(i=null);var o=n.getKeyCreatorParams(r,i);return t._.makeNull(e(o))}:r?function(e){return Array.isArray(e)?e:t._.makeNull(t._.toStringOrNull(e))}:function(e){return t._.makeNull(t._.toStringOrNull(e))}},i.prototype.getFormattedValue=function(e){var r,i=this.valueModel.getValue(e);(this.treeDataTreeList||this.groupingTreeList)&&Array.isArray(i)&&(i=i[i.length-1]);var n=this.valueFormatterService.formatValue(this.setFilterParams.column,null,i,this.valueFormatter,!1);return null!==(r=null==n?t._.toStringOrNull(i):n)&&void 0!==r?r:this.translateForSetFilter("blanks")},i.prototype.applyExcelModeOptions=function(e){"windows"===e.excelMode?(e.buttons||(e.buttons=["apply","cancel"]),null==e.closeOnApply&&(e.closeOnApply=!0)):"mac"===e.excelMode&&(e.buttons||(e.buttons=["reset"]),null==e.applyMiniFilterWhileTyping&&(e.applyMiniFilterWhileTyping=!0),null==e.debounceMs&&(e.debounceMs=500))},i.prototype.addEventListenersForDataChanges=function(){var e=this;this.isValuesTakenFromGrid()&&this.addManagedListener(this.eventService,t.Events.EVENT_CELL_VALUE_CHANGED,(function(t){e.setFilterParams&&t.column===e.setFilterParams.column&&e.syncAfterDataChange()}))},i.prototype.syncAfterDataChange=function(){var e=this;if(!this.valueModel)throw new Error("Value model has not been created.");return this.valueModel.refreshValues().then((function(){e.refresh(),e.onBtApply(!1,!0)}))},i.prototype.setIsLoading=function(e){t._.setDisplayed(this.eFilterLoading,e),e||(this.hardRefreshVirtualList=!0)},i.prototype.initialiseFilterBodyUi=function(){this.initVirtualList(),this.initMiniFilter()},i.prototype.initVirtualList=function(){var e=this;if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");var r=this.localeService.getLocaleTextFunc()("ariaFilterList","Filter List"),i=!!this.setFilterParams.treeList,n=this.virtualList=this.createBean(new t.VirtualList("filter",i?"tree":"listbox",r)),o=this.getRefElement("eSetFilterList");i&&o.classList.add("ag-set-filter-tree-list"),o&&o.appendChild(n.getGui());var l=this.setFilterParams.cellHeight;null!=l&&n.setRowHeight(l);n.setComponentCreator((function(t,r){return e.createSetListItem(t,i,r)}));var s;n.setComponentUpdater((function(t,r){return e.updateSetListItem(t,r)})),s=this.setFilterParams.suppressSelectAll?new M(this.valueModel):new A(this.valueModel,(function(){return e.isSelectAllSelected()})),i&&(s=new V(s)),n.setModel(s)},i.prototype.getSelectAllLabel=function(){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");var e=null!=this.valueModel.getMiniFilter()&&this.setFilterParams.excelMode?"selectAllSearchResults":"selectAll";return this.translateForSetFilter(e)},i.prototype.createSetListItem=function(e,t,r){var i,o,l,s,a,u,c=this;if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");var d,h,p,f,y,m,g=this.valueModel.hasGroups();this.isSetFilterModelTreeItem(e)?(h=e.depth,e.key===n.SELECT_ALL?(d=function(){return c.getSelectAllLabel()},p=g,f=!0,y=function(e){return c.onSelectAll(e.isSelected)},m=function(e){return c.onExpandAll(e.item,e.isExpanded)}):e.children?(d=null!==(l=null===(o=(i=this.setFilterParams).treeListFormatter)||void 0===o?void 0:o.call(i,e.treeKey,e.depth,e.parentTreeKeys))&&void 0!==l?l:e.treeKey,p=!0,y=function(e){return c.onGroupItemSelected(e.item,e.isSelected)},m=function(e){return c.onExpandedChanged(e.item,e.isExpanded)}):(d=null!==(u=null===(a=(s=this.setFilterParams).treeListFormatter)||void 0===a?void 0:a.call(s,e.treeKey,e.depth,e.parentTreeKeys))&&void 0!==u?u:e.treeKey,y=function(e){return c.onItemSelected(e.item.key,e.isSelected)})):e===n.SELECT_ALL?(d=function(){return c.getSelectAllLabel()},y=function(e){return c.onSelectAll(e.isSelected)}):(d=this.valueModel.getValue(e),y=function(e){return c.onItemSelected(e.item,e.isSelected)});var F=this.isSelectedExpanded(e),S=F.isSelected,E=F.isExpanded,M={focusWrapper:r,value:d,params:this.setFilterParams,translate:function(e){return c.translateForSetFilter(e)},valueFormatter:this.valueFormatter,item:e,isSelected:S,isTree:t,depth:h,groupsExist:g,isGroup:p,isExpanded:E,hasIndeterminateExpandState:f},A=this.createBean(new v(M));return A.addEventListener(v.EVENT_SELECTION_CHANGED,y),m&&A.addEventListener(v.EVENT_EXPANDED_CHANGED,m),A},i.prototype.updateSetListItem=function(e,t){var r=this.isSelectedExpanded(e),i=r.isSelected,n=r.isExpanded;t.refresh(e,i,n)},i.prototype.isSelectedExpanded=function(e){var t,r;return this.isSetFilterModelTreeItem(e)?(r=e.expanded,t=e.key===n.SELECT_ALL?this.isSelectAllSelected():e.children?this.areAllChildrenSelected(e):this.valueModel.isKeySelected(e.key)):t=e===n.SELECT_ALL?this.isSelectAllSelected():this.valueModel.isKeySelected(e),{isSelected:t,isExpanded:r}},i.prototype.isSetFilterModelTreeItem=function(e){return void 0!==(null==e?void 0:e.treeKey)},i.prototype.initMiniFilter=function(){var e=this;if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");var t=this.eMiniFilter,r=this.localeService.getLocaleTextFunc();t.setDisplayed(!this.setFilterParams.suppressMiniFilter),t.setValue(this.valueModel.getMiniFilter()),t.onValueChange((function(){return e.onMiniFilterInput()})),t.setInputAriaLabel(r("ariaSearchFilterValues","Search filter values")),this.addManagedListener(t.getInputElement(),"keypress",(function(t){return e.onMiniFilterKeyPress(t)}))},i.prototype.afterGuiAttached=function(e){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");r.prototype.afterGuiAttached.call(this,e),this.resetExpansion(),this.refreshVirtualList();var t=this.eMiniFilter;t.setInputPlaceholder(this.translateForSetFilter("searchOoo")),e&&e.suppressFocus||t.getFocusableElement().focus();var i,n=!(!e||"floatingFilter"!==e.container);i=this.gridOptionsService.is("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0},n?(this.positionableFeature.restoreLastSize(),this.positionableFeature.setResizable(i)):(this.positionableFeature.removeSizeFromEl(),this.positionableFeature.setResizable(!1))},i.prototype.afterGuiDetached=function(){var e;(null===(e=this.setFilterParams)||void 0===e?void 0:e.excelMode)&&(this.resetUiToActiveModel(),this.showOrHideResults())},i.prototype.applyModel=function(e){var t=this;if(void 0===e&&(e="api"),!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");this.setFilterParams.excelMode&&"rowDataUpdated"!==e&&this.valueModel.isEverythingVisibleSelected()&&this.valueModel.selectAllMatchingMiniFilter();var i=r.prototype.applyModel.call(this,e),n=this.getModel();return n?(this.appliedModelKeys=new Set,n.values.forEach((function(e){t.appliedModelKeys.add(t.caseFormat(e))}))):this.appliedModelKeys=null,this.noAppliedModelKeys=0===(null==n?void 0:n.values.length),i},i.prototype.isModelValid=function(e){return!this.setFilterParams||!this.setFilterParams.excelMode||(null==e||e.values.length>0)},i.prototype.doesFilterPass=function(e){var t=this;if(!this.setFilterParams||!this.valueModel||!this.appliedModelKeys)return!0;if(this.noAppliedModelKeys)return!1;var r=e.node,i=e.data;if(this.treeDataTreeList)return this.doesFilterPassForTreeData(r,i);if(this.groupingTreeList)return this.doesFilterPassForGrouping(r,i);var n=this.getValueFromNode(r,i);return this.convertValuesToStrings?this.doesFilterPassForConvertValuesToString(r,n):null!=n&&Array.isArray(n)?0===n.length?this.appliedModelKeys.has(null):n.some((function(e){return t.isInAppliedModel(t.createKey(e,r))})):this.isInAppliedModel(this.createKey(n,r))},i.prototype.doesFilterPassForConvertValuesToString=function(e,t){var r=this,i=this.createKey(t,e);return null!=i&&Array.isArray(i)?0===i.length?this.appliedModelKeys.has(null):i.some((function(e){return r.isInAppliedModel(e)})):this.isInAppliedModel(i)},i.prototype.doesFilterPassForTreeData=function(e,t){var r;return!(null===(r=e.childrenAfterGroup)||void 0===r?void 0:r.length)&&this.isInAppliedModel(this.createKey(this.checkMakeNullDataPath(this.getDataPath(t))))},i.prototype.doesFilterPassForGrouping=function(e,t){var r=this,i=this.columnModel.getRowGroupColumns().map((function(t){return r.valueService.getKeyForNode(t,e)}));return i.push(this.getValueFromNode(e,t)),this.isInAppliedModel(this.createKey(this.checkMakeNullDataPath(i)))},i.prototype.checkMakeNullDataPath=function(e){return e&&(e=e.map((function(e){return t._.toStringOrNull(t._.makeNull(e))}))),(null==e?void 0:e.some((function(e){return null==e})))?null:e},i.prototype.isInAppliedModel=function(e){return this.appliedModelKeys.has(this.caseFormat(e))},i.prototype.getValueFromNode=function(e,t){var r=this.setFilterParams;return(0,r.valueGetter)({api:r.api,colDef:r.colDef,column:r.column,columnApi:r.columnApi,context:r.context,data:t,getValue:function(e){return t[e]},node:e})},i.prototype.getKeyCreatorParams=function(e,t){return void 0===t&&(t=null),{value:e,colDef:this.setFilterParams.colDef,column:this.setFilterParams.column,node:t,data:null==t?void 0:t.data,api:this.setFilterParams.api,columnApi:this.setFilterParams.columnApi,context:this.setFilterParams.context}},i.prototype.onNewRowsLoaded=function(){this.isValuesTakenFromGrid()&&this.syncAfterDataChange()},i.prototype.isValuesTakenFromGrid=function(){return!!this.valueModel&&this.valueModel.getValuesType()===e.TAKEN_FROM_GRID_VALUES},i.prototype.setFilterValues=function(e){var t=this;if(!this.valueModel)throw new Error("Value model has not been created.");this.valueModel.overrideValues(e).then((function(){t.refresh(),t.onUiChanged()}))},i.prototype.resetFilterValues=function(){if(!this.valueModel)throw new Error("Value model has not been created.");this.valueModel.setValuesType(e.TAKEN_FROM_GRID_VALUES),this.syncAfterDataChange()},i.prototype.refreshFilterValues=function(){var e=this;if(!this.valueModel)throw new Error("Value model has not been created.");this.valueModel.isInitialised()&&this.valueModel.refreshValues().then((function(){e.refresh(),e.onUiChanged()}))},i.prototype.onAnyFilterChanged=function(){var e=this;setTimeout((function(){if(e.isAlive()){if(!e.valueModel)throw new Error("Value model has not been created.");e.valueModel.refreshAfterAnyFilterChanged().then((function(t){t&&(e.refresh(),e.showOrHideResults())}))}}),0)},i.prototype.onMiniFilterInput=function(){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");if(this.valueModel.setMiniFilter(this.eMiniFilter.getValue())){var e=this.setFilterParams||{},t=e.applyMiniFilterWhileTyping;!e.readOnly&&t?this.filterOnAllVisibleValues(!1):this.updateUiAfterMiniFilterChange()}},i.prototype.updateUiAfterMiniFilterChange=function(){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");var e=this.setFilterParams||{},t=e.excelMode,r=e.readOnly;null==t||r?this.refresh():null==this.valueModel.getMiniFilter()?this.resetUiToActiveModel():(this.valueModel.selectAllMatchingMiniFilter(!0),this.refresh(),this.onUiChanged()),this.showOrHideResults()},i.prototype.showOrHideResults=function(){if(!this.valueModel)throw new Error("Value model has not been created.");var e=null!=this.valueModel.getMiniFilter()&&this.valueModel.getDisplayedValueCount()<1;t._.setDisplayed(this.eNoMatches,e),t._.setDisplayed(this.eSetFilterList,!e)},i.prototype.resetUiToActiveModel=function(){var e=this;if(!this.valueModel)throw new Error("Value model has not been created.");this.eMiniFilter.setValue(null,!0),this.valueModel.setMiniFilter(null),this.setModelIntoUi(this.getModel()).then((function(){return e.onUiChanged(!1,"prevent")}))},i.prototype.onMiniFilterKeyPress=function(e){var r=this.setFilterParams||{},i=r.excelMode,n=r.readOnly;e.key!==t.KeyCode.ENTER||i||n||this.filterOnAllVisibleValues()},i.prototype.filterOnAllVisibleValues=function(e){void 0===e&&(e=!0);var t=(this.setFilterParams||{}).readOnly;if(!this.valueModel)throw new Error("Value model has not been created.");if(t)throw new Error("Unable to filter in readOnly mode.");this.valueModel.selectAllMatchingMiniFilter(!0),this.refresh(),this.onUiChanged(!1,e?"immediately":"debounce"),this.showOrHideResults()},i.prototype.focusRowIfAlive=function(e){var t=this;null!=e&&window.setTimeout((function(){if(!t.virtualList)throw new Error("Virtual list has not been created.");t.isAlive()&&t.virtualList.focusRow(e)}),0)},i.prototype.onSelectAll=function(e){if(!this.valueModel)throw new Error("Value model has not been created.");if(!this.virtualList)throw new Error("Virtual list has not been created.");e?this.valueModel.selectAllMatchingMiniFilter():this.valueModel.deselectAllMatchingMiniFilter(),this.refreshAfterSelection()},i.prototype.onGroupItemSelected=function(e,t){var r=this,i=function(e){e.children?e.children.forEach((function(e){return i(e)})):r.selectItem(e.key,t)};i(e),this.refreshAfterSelection()},i.prototype.onItemSelected=function(e,t){if(!this.valueModel)throw new Error("Value model has not been created.");if(!this.virtualList)throw new Error("Virtual list has not been created.");this.selectItem(e,t),this.refreshAfterSelection()},i.prototype.selectItem=function(e,t){t?this.valueModel.selectKey(e):this.valueModel.deselectKey(e)},i.prototype.onExpandAll=function(e,t){var r=function(e){e.filterPasses&&e.available&&e.children&&(e.children.forEach((function(e){return r(e)})),e.expanded=t)};r(e),this.refreshAfterExpansion()},i.prototype.onExpandedChanged=function(e,t){e.expanded=t,this.refreshAfterExpansion()},i.prototype.refreshAfterExpansion=function(){var e=this.virtualList.getLastFocusedRow();this.valueModel.updateDisplayedValues("expansion"),this.refresh(),this.focusRowIfAlive(e)},i.prototype.refreshAfterSelection=function(){var e=this.virtualList.getLastFocusedRow();this.refresh(),this.onUiChanged(),this.focusRowIfAlive(e)},i.prototype.setMiniFilter=function(e){this.eMiniFilter.setValue(e),this.onMiniFilterInput()},i.prototype.getMiniFilter=function(){return this.valueModel?this.valueModel.getMiniFilter():null},i.prototype.refresh=function(){if(!this.virtualList)throw new Error("Virtual list has not been created.");this.virtualList.refresh(!this.hardRefreshVirtualList),this.hardRefreshVirtualList&&(this.hardRefreshVirtualList=!1)},i.prototype.getFilterKeys=function(){return this.valueModel?this.valueModel.getKeys():[]},i.prototype.getFilterValues=function(){return this.valueModel?this.valueModel.getValues():[]},i.prototype.getValues=function(){return this.getFilterKeys()},i.prototype.refreshVirtualList=function(){this.setFilterParams&&this.setFilterParams.refreshValuesOnOpen?this.refreshFilterValues():this.refresh()},i.prototype.translateForSetFilter=function(e){return this.localeService.getLocaleTextFunc()(e,m[e])},i.prototype.isSelectAllSelected=function(){if(!this.setFilterParams||!this.valueModel)return!1;if(this.setFilterParams.defaultToNothingSelected){if(this.valueModel.hasSelections()&&this.valueModel.isEverythingVisibleSelected())return!0;if(this.valueModel.isNothingVisibleSelected())return!1}else{if(this.valueModel.hasSelections()&&this.valueModel.isNothingVisibleSelected())return!1;if(this.valueModel.isEverythingVisibleSelected())return!0}},i.prototype.areAllChildrenSelected=function(e){var t=this,r=function(e){if(e.children){var i=!1,n=!1;return e.children.some((function(e){if(!e.filterPasses||!e.available)return!1;var t=r(e);return void 0===t||(t?i=!0:n=!0,i&&n)}))?void 0:i}return t.valueModel.isKeySelected(e.key)};return this.setFilterParams.defaultToNothingSelected?this.valueModel.hasSelections()&&r(e):r(e)},i.prototype.destroy=function(){null!=this.virtualList&&(this.virtualList.destroy(),this.virtualList=null),r.prototype.destroy.call(this)},i.prototype.caseFormat=function(e){return null==e||"string"!=typeof e||this.caseSensitive?e:e.toUpperCase()},i.prototype.resetExpansion=function(){var e,t;if(null===(e=this.setFilterParams)||void 0===e?void 0:e.treeList){var r=null===(t=this.valueModel)||void 0===t?void 0:t.getSelectAllItem();if(this.isSetFilterModelTreeItem(r)){var i=function(e){e.children&&(e.children.forEach((function(e){return i(e)})),e.expanded=!1)};i(r),this.valueModel.updateDisplayedValues("expansion")}}},i.prototype.getModelAsString=function(e){return this.filterModelFormatter.getModelAsString(e,this)},S([t.RefSelector("eMiniFilter")],i.prototype,"eMiniFilter",void 0),S([t.RefSelector("eFilterLoading")],i.prototype,"eFilterLoading",void 0),S([t.RefSelector("eSetFilterList")],i.prototype,"eSetFilterList",void 0),S([t.RefSelector("eFilterNoMatches")],i.prototype,"eNoMatches",void 0),S([t.Autowired("valueFormatterService")],i.prototype,"valueFormatterService",void 0),S([t.Autowired("columnModel")],i.prototype,"columnModel",void 0),S([t.Autowired("valueService")],i.prototype,"valueService",void 0),i}(t.ProvidedFilter),M=function(){function e(e){this.model=e}return e.prototype.getRowCount=function(){return this.model.getDisplayedValueCount()},e.prototype.getRow=function(e){return this.model.getDisplayedItem(e)},e.prototype.isRowSelected=function(e){return this.model.isKeySelected(this.getRow(e))},e.prototype.areRowsEqual=function(e,t){return e===t},e}(),A=function(){function e(e,t){this.model=e,this.isSelectAllSelected=t}return e.prototype.getRowCount=function(){return this.model.getDisplayedValueCount()+1},e.prototype.getRow=function(e){return 0===e?this.model.getSelectAllItem():this.model.getDisplayedItem(e-1)},e.prototype.isRowSelected=function(e){return 0===e?this.isSelectAllSelected():this.model.isKeySelected(this.getRow(e))},e.prototype.areRowsEqual=function(e,t){return e===t},e}(),V=function(){function e(e){this.model=e}return e.prototype.getRowCount=function(){return this.model.getRowCount()},e.prototype.getRow=function(e){return this.model.getRow(e)},e.prototype.areRowsEqual=function(e,t){return null==e&&null==t||null!=e&&null!=t&&e.treeKey===t.treeKey&&e.depth===t.depth},e}(),b=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),L=function(e,t,r,i){var n,o=arguments.length,l=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(l=(o<3?n(l):o>3?n(t,r,l):n(t,r))||l);return o>3&&l&&Object.defineProperty(t,r,l),l},T=function(e){function r(){var t=e.call(this,'\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field ref="eFloatingFilterText"></ag-input-text-field>\n            </div>')||this;return t.availableValuesListenerAdded=!1,t.filterModelFormatter=new g,t}return b(r,e),r.prototype.destroy=function(){e.prototype.destroy.call(this)},r.prototype.init=function(e){var t=this.columnModel.getDisplayNameForColumn(e.column,"header",!0),r=this.localeService.getLocaleTextFunc();this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(t+" "+r("ariaFilterInput","Filter Input")).addGuiEventListener("click",(function(){return e.showParentFilter()})),this.params=e},r.prototype.onParentModelChanged=function(e){this.updateFloatingFilterText(e)},r.prototype.parentSetFilterInstance=function(e){this.params.parentFilterInstance((function(t){if(!(t instanceof E))throw new Error("AG Grid - SetFloatingFilter expects SetFilter as its parent");e(t)}))},r.prototype.addAvailableValuesListener=function(){var e=this;this.parentSetFilterInstance((function(t){var r=t.getValueModel();r&&e.addManagedListener(r,p.EVENT_AVAILABLE_VALUES_CHANGED,(function(){return e.updateFloatingFilterText()}))})),this.availableValuesListenerAdded=!0},r.prototype.updateFloatingFilterText=function(e){var t=this;this.availableValuesListenerAdded||this.addAvailableValuesListener(),this.parentSetFilterInstance((function(r){t.eFloatingFilterText.setValue(t.filterModelFormatter.getModelAsString(e,r))}))},L([t.RefSelector("eFloatingFilterText")],r.prototype,"eFloatingFilterText",void 0),L([t.Autowired("columnModel")],r.prototype,"columnModel",void 0),r}(t.Component),C={version:"29.1.0",moduleName:t.ModuleNames.SetFilterModule,beans:[],userComponents:[{componentName:"agSetColumnFilter",componentClass:E},{componentName:"agSetColumnFloatingFilter",componentClass:T}],dependantModules:[r.EnterpriseCoreModule]};exports.SetFilter=E,exports.SetFilterModule=C;